<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validator Tests - Simple Data Cleaner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="validators.js"></script>
</head>

<body class="min-h-screen bg-gray-50 p-8">
    <div class="max-w-7xl mx-auto">
        <h1 class="text-4xl font-bold mb-8">UK Data Validator Tests</h1>

        <div class="mb-8">
            <button id="runAllTests" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Run All
                Tests</button>
            <button id="runFailedOnly"
                class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 ml-4">Run Failed Tests
                Only</button>
        </div>

        <div id="testResults"></div>
    </div>

    <script>
        const phoneValidator = new PhoneNumberValidator('international');
        const niValidator = new NINumberValidator();
        const postcodeValidator = new PostcodeValidator();
        const sortCodeValidator = new SortCodeValidator();

        const testCases = {
            phone_numbers: [
                // Basic variations - UK format
                { input: '07123 456789', expected: true, description: 'Standard UK mobile with spaces' },
                { input: '0712 345 6789', expected: true, description: 'UK mobile with more spaces' },
                { input: '07 123 456 789', expected: true, description: 'UK mobile with extra spaces' },
                { input: '0 7123 456789', expected: true, description: 'UK mobile with space after leading 0' },
                { input: '07123456789', expected: true, description: 'UK mobile no spaces' },
                { input: '7700 900123', expected: true, description: 'UK mobile without leading 0' },
                { input: '7123456789', expected: true, description: 'UK mobile missing leading 0 entirely' },

                // International format
                { input: '+44 7700 900123', expected: true, description: 'International format with spaces' },
                { input: '+44 7123 456789', expected: true, description: 'International mobile format' },
                { input: '+447 123 456 789', expected: true, description: 'International with unusual spacing' },
                { input: '00447700900123', expected: true, description: 'Double zero prefix' },
                { input: '0044 7123 456789', expected: true, description: 'Double zero with spaces' },
                { input: '447123456789', expected: true, description: 'Missing + from country code' },
                { input: '44 7123456789', expected: true, description: 'Country code without + or 00' },

                // Dashes/Hyphens
                { input: '07123-456789', expected: true, description: 'UK format with hyphen' },
                { input: '0712-345-6789', expected: true, description: 'UK format multiple hyphens' },
                { input: '07-123-456-789', expected: true, description: 'UK format many hyphens' },
                { input: '+44-7123-456789', expected: true, description: 'International with hyphens' },
                { input: '+44-712-345-6789', expected: true, description: 'International multiple hyphens' },

                // Dots/Periods
                { input: '07123.456789', expected: true, description: 'UK format with dots' },
                { input: '0712.345.6789', expected: true, description: 'UK format multiple dots' },
                { input: '+44.7123.456789', expected: true, description: 'International with dots' },

                // Parentheses
                { input: '(07123) 456789', expected: true, description: 'UK format with parentheses' },
                { input: '(0712) 345 6789', expected: true, description: 'UK format parentheses with space' },
                { input: '+44 (0)7123 456789', expected: true, description: 'International with (0) notation' },
                { input: '+44(0)7123456789', expected: true, description: 'International (0) no spaces' },
                { input: '+44 (0) 7123 456789', expected: true, description: 'International (0) with spaces' },
                { input: '+44(7123)456789', expected: true, description: 'International whole number in brackets' },

                // Underscores
                { input: '07123_456789', expected: true, description: 'UK format with underscores' },
                { input: '0712_345_6789', expected: true, description: 'UK format multiple underscores' },
                { input: '+44_7123_456789', expected: true, description: 'International with underscores' },

                // Slashes
                { input: '07123/456789', expected: true, description: 'UK format with slashes' },
                { input: '0712/345/6789', expected: true, description: 'UK format multiple slashes' },
                { input: '+44/7123/456789', expected: true, description: 'International with slashes' },

                // Commas
                { input: '07123,456789', expected: true, description: 'UK format with commas' },
                { input: '0712,345,6789', expected: true, description: 'UK format multiple commas' },

                // Mixed formatting
                { input: '07123-456 789', expected: true, description: 'Mixed hyphens and spaces' },
                { input: '07 123-456-789', expected: true, description: 'Mixed spaces and hyphens' },
                { input: '(07123) 456-789', expected: true, description: 'Mixed parentheses and hyphens' },
                { input: '+44 (0)7123-456789', expected: true, description: 'Mixed (0) and hyphens' },
                { input: '+44 7123-456-789', expected: true, description: 'International mixed separators' },

                // Wrapping characters
                { input: '"07123456789"', expected: true, description: 'Double quotes' },
                { input: "'07123456789'", expected: true, description: 'Single quotes' },
                { input: ' 07123456789', expected: true, description: 'Leading space' },
                { input: '07123456789 ', expected: true, description: 'Trailing space' },
                { input: ' 07123456789 ', expected: true, description: 'Leading and trailing spaces' },

                // Scientific notation from Excel
                { input: '4.47701E+11', expected: true, description: 'Excel scientific notation' },
                { input: '4.47700900123E+11', expected: true, description: 'Excel scientific notation long' },

                // Labels and prefixes
                { input: 'Mobile: 07123456789', expected: true, description: 'Mobile label prefix' },
                { input: 'Mob: 07123456789', expected: true, description: 'Mob label prefix' },
                { input: 'M: 07123456789', expected: true, description: 'M label prefix' },
                { input: 'Tel: 07123456789', expected: true, description: 'Tel label prefix' },
                { input: 'Phone: 07123456789', expected: true, description: 'Phone label prefix' },
                { input: 'Cell: 07123456789', expected: true, description: 'Cell label prefix' },
                { input: 'UK: 07123456789', expected: true, description: 'UK label prefix' },
                { input: 'Call 07123456789', expected: true, description: 'Call prefix' },
                { input: 'Contact: 07123456789', expected: true, description: 'Contact prefix' },
                { input: '#07123456789', expected: true, description: 'Hash prefix' },
                { input: 'No: 07123456789', expected: true, description: 'No label prefix' },
                { input: '07123456789 (mobile)', expected: true, description: 'Mobile suffix parentheses' },
                { input: '07123456789 (UK)', expected: true, description: 'UK suffix parentheses' },
                { input: '07123456789 - mobile', expected: true, description: 'Mobile suffix with dash' },

                // Extensions
                { input: '07123456789 ext 123', expected: true, description: 'Mobile with ext extension' },
                { input: '07123456789 x123', expected: true, description: 'Mobile with x extension' },
                { input: '07123456789 #123', expected: true, description: 'Mobile with hash extension' },

                // Names and context
                { input: '07123456789 (John)', expected: true, description: 'Phone with name in parentheses' },
                { input: '07123456789 - John Smith', expected: true, description: 'Phone with name after dash' },
                { input: 'John: 07123456789', expected: true, description: 'Name before phone with colon' },
                { input: 'Sarah 07123456789', expected: true, description: 'Name before phone no colon' },

                // Multiple numbers
                { input: '07123456789 / 07987654321', expected: true, description: 'Two numbers with slash' },
                { input: '07123456789 or 07987654321', expected: true, description: 'Two numbers with or' },
                { input: '07123456789; 07987654321', expected: true, description: 'Two numbers with semicolon' },
                { input: '07123456789, 07987654321', expected: true, description: 'Two numbers with comma' },
                { input: '07123456789 & 07987654321', expected: true, description: 'Two numbers with ampersand' },

                // Landline variations
                { input: '020 7946 0958', expected: true, description: 'London landline' },
                { input: '02079460958', expected: true, description: 'London landline no spaces' },
                { input: '+44 20 7946 0958', expected: true, description: 'International London format' },
                { input: '020-7946-0958', expected: true, description: 'London landline with hyphens' },

                // Invalid formats
                { input: '123', expected: false, description: 'Too short' },
                { input: '123456789', expected: false, description: 'Wrong length' },
                { input: 'abcdefghij', expected: false, description: 'All letters' },
                { input: '++447700900123', expected: false, description: 'Double plus' },
                { input: '44770090012', expected: false, description: 'Wrong length international' },
                { input: '+440 7123456789', expected: false, description: 'Extra 0 after country code' },
                { input: '+440 07123456789', expected: false, description: 'Includes 0 after country code' },
                { input: '007123456789', expected: false, description: 'Extra 0 at start' },
                { input: '+4447123456789', expected: false, description: 'Extra 4 in country code' },
                { input: '071234567890', expected: false, description: 'Extra digit at end' },
            ],

            ni_numbers: [
                // Basic spacing variations
                { input: 'AB 12 34 56 C', expected: true, description: 'Spaces between all groups' },
                { input: 'AB12 34 56 C', expected: true, description: 'Letters together, spaced digits' },
                { input: 'AB 123456 C', expected: true, description: 'Digits together' },
                { input: 'AB 12 3456 C', expected: true, description: 'Mixed digit spacing' },
                { input: 'AB 1234 56 C', expected: true, description: 'Alternative digit spacing' },
                { input: 'AB123 456 C', expected: true, description: 'First digits together' },
                { input: 'AB123456C', expected: true, description: 'Standard format no spaces' },
                { input: 'A B 12 34 56 C', expected: true, description: 'Space between letters' },

                // Separator types
                { input: 'AB-12-34-56-C', expected: true, description: 'Hyphens' },
                { input: 'AB-123456-C', expected: true, description: 'Hyphens with digits together' },
                { input: 'AB.12.34.56.C', expected: true, description: 'Dots' },
                { input: 'AB.123456.C', expected: true, description: 'Dots with digits together' },
                { input: 'AB/12/34/56/C', expected: true, description: 'Slashes' },
                { input: 'AB/123456/C', expected: true, description: 'Slashes with digits together' },
                { input: 'AB_12_34_56_C', expected: true, description: 'Underscores' },
                { input: 'AB:12:34:56:C', expected: true, description: 'Colons' },
                { input: 'AB;12;34;56;C', expected: true, description: 'Semicolons' },
                { input: 'AB,12,34,56,C', expected: true, description: 'Commas' },
                { input: 'AB|12|34|56|C', expected: true, description: 'Pipes' },

                // Parentheses and brackets
                { input: '(AB)12 34 56 C', expected: true, description: 'Parentheses around letters' },
                { input: 'AB(12)34 56 C', expected: true, description: 'Parentheses around first digits' },
                { input: 'AB 12 34 56(C)', expected: true, description: 'Parentheses around last letter' },
                { input: '(AB123456C)', expected: true, description: 'Parentheses around whole number' },
                { input: '[AB]12 34 56 C', expected: true, description: 'Square brackets around letters' },
                { input: '{AB}12 34 56 C', expected: true, description: 'Curly brackets around letters' },
                { input: 'AB[123456]C', expected: true, description: 'Square brackets around digits' },

                // Mixed formatting
                { input: 'AB 12-34-56 C', expected: true, description: 'Mixed spaces and hyphens' },
                { input: 'AB-12 34 56-C', expected: true, description: 'Alternating hyphens and spaces' },
                { input: 'AB.12-34.56-C', expected: true, description: 'Mixed dots and hyphens' },
                { input: 'AB 12.34.56 C', expected: true, description: 'Mixed spaces and dots' },
                { input: 'AB-123456 C', expected: true, description: 'Hyphen before digits together' },

                // Lowercase variations
                { input: 'ab123456c', expected: true, description: 'All lowercase' },
                { input: 'ab 12 34 56 c', expected: true, description: 'Lowercase with spaces' },
                { input: 'Ab123456C', expected: true, description: 'First letter lowercase' },
                { input: 'aB123456C', expected: true, description: 'Second letter lowercase' },
                { input: 'AB123456c', expected: true, description: 'Last letter lowercase' },
                { input: 'ab123456C', expected: true, description: 'First two letters lowercase' },

                // Wrapping characters
                { input: '"AB123456C"', expected: true, description: 'Double quotes' },
                { input: "'AB123456C'", expected: true, description: 'Single quotes' },
                { input: ' AB123456C', expected: true, description: 'Leading space' },
                { input: 'AB123456C ', expected: true, description: 'Trailing space' },
                { input: ' AB123456C ', expected: true, description: 'Leading and trailing spaces' },
                { input: '*AB123456C', expected: true, description: 'Leading asterisk' },
                { input: '#AB123456C', expected: true, description: 'Leading hash' },
                { input: "'AB123456C", expected: true, description: 'Leading apostrophe (Excel)' },

                // Labels and prefixes
                { input: 'NI: AB123456C', expected: true, description: 'NI prefix with colon' },
                { input: 'NI Number: AB123456C', expected: true, description: 'NI Number prefix' },
                { input: 'NINO: AB123456C', expected: true, description: 'NINO prefix' },
                { input: 'National Insurance: AB123456C', expected: true, description: 'Full label prefix' },
                { input: 'AB123456C (NI)', expected: true, description: 'NI suffix' },
                { input: 'NI - AB123456C', expected: true, description: 'NI with dash' },
                { input: 'UK AB123456C', expected: true, description: 'UK prefix' },
                { input: 'GB: AB123456C', expected: true, description: 'GB prefix with colon' },

                // Invalid formats
                { input: 'BG123456C', expected: false, description: 'Banned prefix BG' },
                { input: 'GB123456C', expected: false, description: 'Banned prefix GB' },
                { input: 'KN123456C', expected: false, description: 'Banned prefix KN' },
                { input: 'NK123456C', expected: false, description: 'Banned prefix NK' },
                { input: 'NT123456C', expected: false, description: 'Banned prefix NT' },
                { input: 'TN123456C', expected: false, description: 'Banned prefix TN' },
                { input: 'ZZ123456C', expected: false, description: 'Banned prefix ZZ' },
                { input: 'OO123456C', expected: false, description: 'Admin prefix OO' },
                { input: 'FY123456C', expected: false, description: 'Admin prefix FY' },
                { input: 'NC123456C', expected: false, description: 'Admin prefix NC' },
                { input: 'PZ123456C', expected: false, description: 'Admin prefix PZ' },
                { input: 'PP999999P', expected: false, description: 'Special invalid PP number' },
                { input: '11a11111', expected: false, description: 'TRN format' },
                { input: '123456C', expected: false, description: 'Missing first letters' },
                { input: 'AB123456', expected: false, description: 'Missing last letter' },
                { input: 'ABCDEFGHI', expected: false, description: 'All letters' },
                { input: '123456789', expected: false, description: 'All numbers' },
            ],

            postcodes: [
                // Standard spacing
                { input: 'SW1A 1AA', expected: true, description: 'London with space' },
                { input: 'SW1A1AA', expected: true, description: 'London no space' },
                { input: 'M1 1AA', expected: true, description: 'Manchester with space' },
                { input: 'M11AA', expected: true, description: 'Manchester no space' },
                { input: 'M60 1AA', expected: true, description: 'Manchester format' },
                { input: 'M601AA', expected: true, description: 'Manchester no space' },
                { input: 'W1A 1AA', expected: true, description: 'Westminster' },
                { input: 'EC1A 1BB', expected: true, description: 'Central London' },
                { input: 'B33 8TH', expected: true, description: 'Birmingham' },

                // Different separators
                { input: 'SW1A-1AA', expected: true, description: 'Hyphen separator' },
                { input: 'SW1A.1AA', expected: true, description: 'Dot separator' },
                { input: 'SW1A/1AA', expected: true, description: 'Slash separator' },
                { input: 'SW1A_1AA', expected: true, description: 'Underscore separator' },
                { input: 'SW1A:1AA', expected: true, description: 'Colon separator' },
                { input: 'SW1A;1AA', expected: true, description: 'Semicolon separator' },
                { input: 'SW1A,1AA', expected: true, description: 'Comma separator' },
                { input: 'SW1A|1AA', expected: true, description: 'Pipe separator' },

                // Lowercase variations
                { input: 'sw1a 1aa', expected: true, description: 'All lowercase' },
                { input: 'sw1a1aa', expected: true, description: 'Lowercase no space' },
                { input: 'Sw1a 1aa', expected: true, description: 'Mixed case' },
                { input: 'SW1a 1AA', expected: true, description: 'Mixed case 2' },
                { input: 'm1 1aa', expected: true, description: 'Lowercase M format' },

                // Labels and prefixes
                { input: 'Postcode: SW1A 1AA', expected: true, description: 'Postcode label' },
                { input: 'PC: SW1A1AA', expected: true, description: 'PC prefix' },
                { input: 'Address: SW1A 1AA', expected: true, description: 'Address label' },
                { input: 'SW1A 1AA (postcode)', expected: true, description: 'Postcode suffix' },
                { input: 'UK SW1A 1AA', expected: true, description: 'UK prefix' },
                { input: 'London SW1A 1AA', expected: true, description: 'London prefix' },
                { input: 'SW1A 1AA, UK', expected: true, description: 'UK suffix' },
                { input: 'SW1A 1AA, London', expected: true, description: 'London suffix' },

                // Wrapping characters
                { input: '"SW1A 1AA"', expected: true, description: 'Double quotes' },
                { input: "'SW1A1AA'", expected: true, description: 'Single quotes' },
                { input: '*SW1A 1AA', expected: true, description: 'Leading asterisk' },
                { input: '#SW1A1AA', expected: true, description: 'Leading hash' },
                { input: ' SW1A 1AA', expected: true, description: 'Leading space' },
                { input: 'SW1A 1AA ', expected: true, description: 'Trailing space' },
                { input: ' SW1A 1AA ', expected: true, description: 'Leading and trailing spaces' },
                { input: "'SW1A 1AA", expected: true, description: 'Leading apostrophe (Excel)' },

                // With address context
                { input: '10 Downing Street, SW1A 1AA', expected: true, description: 'With street address' },
                { input: 'SW1A 1AA, 10 Downing Street', expected: true, description: 'Address after postcode' },

                // All postcode format variations (no space)
                { input: 'CR26XH', expected: true, description: 'AA# format no space' },
                { input: 'DN551PT', expected: true, description: 'AA## format no space' },
                { input: 'W1A1AA', expected: true, description: 'A#A format no space' },
                { input: 'EC1A1BB', expected: true, description: 'AA#A format no space' },

                // Invalid formats
                { input: '123456', expected: false, description: 'All numbers' },
                { input: 'ABCDEF', expected: false, description: 'All letters' },
                { input: 'M', expected: false, description: 'Too short' },
                { input: 'M1', expected: false, description: 'Too short' },
            ],

            sort_codes: [
                // Spacing variations
                { input: '12 34 56', expected: true, description: 'Standard spaces' },
                { input: '123 456', expected: true, description: 'Uneven spacing' },
                { input: '12 3456', expected: true, description: 'Last group together' },
                { input: '1234 56', expected: true, description: 'First group together' },
                { input: '123456', expected: true, description: 'No separators' },

                // Separator types
                { input: '12-34-56', expected: true, description: 'Hyphens' },
                { input: '12.34.56', expected: true, description: 'Dots' },
                { input: '12/34/56', expected: true, description: 'Slashes' },
                { input: '12:34:56', expected: true, description: 'Colons' },
                { input: '12;34;56', expected: true, description: 'Semicolons' },
                { input: '12,34,56', expected: true, description: 'Commas' },
                { input: '12|34|56', expected: true, description: 'Pipes' },
                { input: '12_34_56', expected: true, description: 'Underscores' },

                // Mixed formatting
                { input: '12-34 56', expected: true, description: 'Mixed hyphens and spaces' },
                { input: '12 34-56', expected: true, description: 'Mixed spaces and hyphens' },
                { input: '12.34-56', expected: true, description: 'Mixed dots and hyphens' },

                // Labels and prefixes
                { input: 'Sort Code: 12-34-56', expected: true, description: 'Sort Code label' },
                { input: 'SC: 123456', expected: true, description: 'SC prefix' },
                { input: 'Bank: 12-34-56', expected: true, description: 'Bank label' },
                { input: '12-34-56 (sort code)', expected: true, description: 'Sort code suffix' },
                { input: 'SC - 123456', expected: true, description: 'SC with dash' },
                { input: 'UK 12-34-56', expected: true, description: 'UK prefix' },
                { input: 'Barclays 12-34-56', expected: true, description: 'Barclays bank name' },
                { input: 'HSBC: 12-34-56', expected: true, description: 'HSBC bank name' },

                // Wrapping characters
                { input: '"12-34-56"', expected: true, description: 'Double quotes' },
                { input: "'123456'", expected: true, description: 'Single quotes' },
                { input: '*12-34-56', expected: true, description: 'Leading asterisk' },
                { input: '#123456', expected: true, description: 'Leading hash' },
                { input: ' 12-34-56', expected: true, description: 'Leading space' },
                { input: '12-34-56 ', expected: true, description: 'Trailing space' },
                { input: ' 12-34-56 ', expected: true, description: 'Leading and trailing spaces' },
                { input: "'12-34-56", expected: true, description: 'Leading apostrophe (Excel)' },

                // Scientific notation
                { input: '1.23456E+5', expected: true, description: 'Excel scientific notation' },

                // Leading zeros and edge cases
                { input: '00-00-00', expected: true, description: 'Zero sort code' },
                { input: '01-23-45', expected: true, description: 'Leading zeros' },
                { input: '012345', expected: true, description: 'Leading zero no separators' },
                { input: '00-12-34-56', expected: true, description: '8 digits with leading zeros' },

                // With account numbers (should extract sort code)
                { input: '12-34-56 / 12345678', expected: true, description: 'Sort code with account number' },
                { input: 'Sort: 12-34-56 Account: 12345678', expected: true, description: 'Multiple fields' },

                // Invalid formats
                { input: '12345', expected: false, description: 'Too short (5 digits)' },
                { input: '1234567', expected: false, description: 'Too long (7 digits)' },
                { input: '12-34-567', expected: false, description: '7 digits with hyphens' },
                { input: '12', expected: false, description: 'Too short' },
            ]
        };

        function runTest(validator, input, expected, description) {
            const result = validator.validate(input);
            const passed = (result.isValid === expected);

            return {
                passed,
                description,
                input,
                expected,
                got: result.isValid,
                error: result.error,
                fixed: result.fixed
            };
        }

        function runAllTests() {
            const results = {
                phone_numbers: [],
                ni_numbers: [],
                postcodes: [],
                sort_codes: []
            };

            // Run phone number tests
            const phoneValidator = new PhoneNumberValidator('international');
            results.phone_numbers = testCases.phone_numbers.map(test =>
                runTest(phoneValidator, test.input, test.expected, test.description)
            );

            // Run NI number tests
            const niValidator = new NINumberValidator();
            results.ni_numbers = testCases.ni_numbers.map(test =>
                runTest(niValidator, test.input, test.expected, test.description)
            );

            // Run postcode tests
            const postcodeValidator = new PostcodeValidator();
            results.postcodes = testCases.postcodes.map(test =>
                runTest(postcodeValidator, test.input, test.expected, test.description)
            );

            // Run sort code tests
            const sortCodeValidator = new SortCodeValidator();
            results.sort_codes = testCases.sort_codes.map(test =>
                runTest(sortCodeValidator, test.input, test.expected, test.description)
            );

            displayResults(results);
        }

        function displayResults(results) {
            const output = document.getElementById('testResults');
            let html = '';

            for (const [category, tests] of Object.entries(results)) {
                const passed = tests.filter(t => t.passed).length;
                const total = tests.length;
                const percentage = Math.round((passed / total) * 100);

                html += `
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                        <h2 class="text-2xl font-bold mb-4">${category.replace(/_/g, ' ').toUpperCase()}</h2>
                        <div class="mb-4">
                            <span class="text-2xl font-bold ${percentage === 100 ? 'text-green-600' : 'text-orange-600'}">
                                ${passed}/${total}
                            </span>
                            <span class="text-gray-600">tests passed (${percentage}%)</span>
                        </div>
                `;

                const failedTests = tests.filter(t => !t.passed);

                if (failedTests.length > 0) {
                    html += `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-4">
                            <h3 class="font-semibold text-red-900 mb-2">Failed Tests:</h3>
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b">
                                        <th class="text-left p-2">Input</th>
                                        <th class="text-left p-2">Expected</th>
                                        <th class="text-left p-2">Got</th>
                                        <th class="text-left p-2">Error/Fixed</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;

                    failedTests.forEach(test => {
                        html += `
                            <tr class="border-b">
                                <td class="p-2 font-mono">${escapeHtml(test.input)}</td>
                                <td class="p-2">${test.expected ? 'Valid' : 'Invalid'}</td>
                                <td class="p-2">${test.got ? 'Valid' : 'Invalid'}</td>
                                <td class="p-2 text-red-600">${escapeHtml(test.error || test.fixed || 'N/A')}</td>
                            </tr>
                        `;
                    });

                    html += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }

                html += `</div>`;
            }

            output.innerHTML = html;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        document.getElementById('runAllTests').addEventListener('click', runAllTests);

        runAllTests(); // Run on page load
    </script>
</body>

</html>